/*! event-organiser-csv 0.3.2 */
(function(e){e(document).ready(function(){var t={};if(t.errorMessage=function(t){e("#eo-csv-error p").text(t),e("#eo-csv-error").show(),e("#eo-csv-submit").attr("disabled","disabled").hide()},t.clearError=function(){e("#eo-csv-error p").text(""),e("#eo-csv-error").hide(),e("#eo-csv-submit").removeAttr("disabled").show()},e("#eo-csv-preview").on("submit",function(o){var a=!1;return e(".eo-csv-import-column-selection select").each(function(){"start"===e(this).val()&&(a=!0)}),a?!0:(t.errorMessage(eo_csv.i18n.select_start_column),o.preventDefault(),!1)}),e(".eo-first-row-is-header").on("change",function(){e(".eo-csv-row-0").toggleClass("eo-csv-row-is-header",e(this).is(":checked"))}),e(".eo-csv-table-wrap").on("change",".eo-csv-col-map",function(){t.clearError();var o=e(this).parent("td").find(".eo-csv-col-map-meta");o.toggle("post_meta"===e(this).val()),o.attr("placeholder",e(this).find("option:selected").text())}),e('input[name="delimiter"]').change(function(){t.clearError();var o;switch(e(this).val()){case"space":o=" ";break;case"tab":o="	";break;case"semicolon":o=";";break;default:o=","}if(!eo_csv_data.hasOwnProperty("input")||!eo_csv_data.input)return t.errorMessage("Cannot read file content. Please check that the uploaded file is CSV encoded."),void 0;var a;try{a=e.csv.toArrays(eo_csv_data.input,{delimiter:'"',separator:o})}catch(r){return t.errorMessage("The CSV file is invalid with the chosen delimiter. Please try a different one."),console.log(r),e(".eo-csv-table-wrap table thead").html(""),e(".eo-csv-table-wrap table tfoot").html(""),e(".eo-csv-table-wrap table tbody").html(""),void 0}for(var s=a[0].length,c=e(".eo-csv-table-wrap table"),n=c.find("tbody").html(""),l=c.find("tbody").html(""),i=e('<tr class="eo-csv-import-column-selection">'),d=e("<tr></tr>"),v=0;s>v;v++){var p="",h=v;if(0===h)p="A";else for(;h>=0;){var u=h%26;h=Math.floor(h/26)-1,p=String.fromCharCode(65+u)+p}var m='<td><select class="eo-csv-col-map" name="column_map['+v+'][col]" style="width: 100%;" data-eo-csv-col="1">'+'<option value="0"> Please select </option>';for(var f in eo_csv.columns)eo_csv.columns.hasOwnProperty(f)&&(m+='<option value="'+f+'">'+eo_csv.columns[f]+"</option>");m+='</select><input type="text" name="column_map['+v+'][other]" style="display:none" value="" class="eo-csv-col-map-meta">'+"</td>",i.append(e(m)),d.append(e("<th>"+p+"</th>"))}l.append(i),l.append(d);for(var b,_,w=0;a.length>w;w++){for(b=e('<tr class="eo-csv-row-'+w+'"></tr>'),v=0;s>v;v++){var g=a[w][v];_=e('<td><div class="eo-csv-cell-content"></div></td>').text(g),b.append(_)}n.append(b)}}),eo_csv_data.hasOwnProperty("input")&&eo_csv_data.input)for(var o=[" ","	",",",";"],a=0;o.length>a;a++){var r=o[a];try{e.csv.toArrays(eo_csv_data.input,{delimiter:'"',separator:r}),e('input[name="delimiter"]').eq(0).click();break}catch(s){continue}}else t.errorMessage("Cannot read file content. Please check that the uploaded file is CSV encoded.")})})(jQuery);